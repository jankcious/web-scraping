BrightTag.instance.dbe('page :: name :: on-load', '(function(){\r\nvar name \x3d  (digitalData.page.sephoraPageInfo.pageName || wa.pageName);\r\n /*Temp fix because c6 is broken when we don\x27t set a sephora page name in dd*/\r\n\t//Update previousPageName after determining page name here:\r\n        digitalData.util.setCookie(\x22prevPageName\x22, name)\r\n        /* End Temp fix  */\r\n\r\nreturn name;\r\n\r\n\r\n}())', {pageId:2047990});
BrightTag.instance.dbe('campaign', 'wa.campaign', {pageId:2047990});
BrightTag.instance.dbe('sitecatalyst :: events string :: on-load', '(function() { \r\n\r\n  var events \x3d [],\r\n      ddEvents \x3d wa.safelyRead([\x22event\x22, \x220\x22, \x22eventInfo\x22, \x22attributes\x22, \x22eventStrings\x22]),\r\n      i;\r\n  if(wa.orderObject){return wa.orderObject.events;}\r\n\r\n  //Add events from the new digitalData object\r\n  if(ddEvents \x26\x26 ddEvents.length){\r\n    for(i\x3d0; i\x3cddEvents.length; i+\x3d1){\r\n      events.push(ddEvents[i]);\r\n    }\r\n  }\r\n\r\n  if(wa.path.length \x3e 2 \x26\x26 wa.path[2].toLowerCase() \x3d\x3d \x22sephora stores near you\x22){\r\n    events.push(\x22event30\x22);\r\n  }\r\n\r\n  //overlay only for BI page. might want to create a new DBE for this page.\r\n  var showing\x3dwa.getCookie(\x27showingOverlay\x27);\r\n  if(showing \x3d\x3d \x22true\x22){\r\n    wa.setCookie(\x27showingOverlay\x27,\x27false\x27);\r\n    events.push(\x22event81\x22);\r\n  }\r\n\r\n  showing\x3dwa.getCookie(\x27trackIntlModal\x27);\r\n  if(showing \x3d\x3d \x22true\x22){\r\n    wa.setCookie(\x27trackIntlModal\x27, \x22false\x22, 1, true);\r\n    events.push(\x22event66\x22);\r\n  }\r\n\r\n  if(wa.emailOptIn){\r\n    events.push(\x22event6\x22);\r\n  }\r\n\r\n  if(wa.userJustSignedIn){ \r\n    events.push(\x22event100\x22);\r\n  }\r\n\r\n  if(wa.registerAccount){\r\n    events.push(\x22event15\x22);\r\n    if(wa.biOptIn \x3d\x3d undefined){\r\n      events.push(\x22event12\x22);\r\n    }\r\n  }\r\n\r\n  if (typeof wa.sawCaptcha !\x3d\x3d \x22undefined\x22) {\r\n    if (wa.sawCaptcha) {\r\n      events.push(\x22event39\x22);\r\n    }\r\n  }\r\n\r\n  if(wa.biOptIn){\r\n    events.push(\x22event11\x22);\r\n  }\r\n  if(wa.mergeCartEvent){events.push(\x22event37\x22)};\r\n\r\n  return events.join(\x22,\x22) || \x22\x22;\r\n})();\r\n', {pageId:2047990});
BrightTag.instance.dbe('campaign :: email :: tracking code', 'wa.emailTrackingCode || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('user :: beauty status', '(function(){\r\nreturn wa.getUserProp(\x22biType\x22) || \x22non-bi\x22;\r\n})()', {pageId:2047990});
BrightTag.instance.dbe('page load info :: prop55', 'wa.anaPageLoadInfo.prop55 || \x22\x22;\r\n\r\n', {pageId:2047990});
BrightTag.instance.dbe('page :: error message', '(function(){ \r\n\tvar errorMsg \x3d (wa.errorMsg || []),\r\n\t\tending;\r\n\r\n\tif (errorMsg.length){\r\n\t\terrorMsg.join(\x22,\x22).replace(/(\\n)|(\\t)|(  )/g,\x22\x22).toLowerCase();\r\n\r\n\t\tif(errorMsg.length\x3e100){\r\n\t\t\treturn errorMsg.slice(0,100) + \x22...\x22;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn errorMsg;\r\n\t\t}\r\n\t}\r\n}())\r\n', {pageId:2047990});
BrightTag.instance.dbe('page :: detect features', '(function(){\r\n  \r\n/* Report on whether a product page has swatches, find in store, videos, etc. */\r\nif ((typeof wa_v2 !\x3d \x22undefined\x22) \x26\x26 wa_v2.pageType \x3d\x3d\x3d \x22product\x22){\r\n  var tabs \x3d $(\x22.pdp-tabs .tab-text\x22).text().toLowerCase(),\r\n      onlyFewLeft \x3d $(\x22.sku-messaging .out-of-stock:visible\x22).find(\x22b\x22).text().toLowerCase(),\r\n      i \x3d 0;\r\n  var flashMsg \x3d function(){\r\n    var isRouge \x3d wa.biType \x3d\x3d\x3d \x22rouge\x22;\r\n\r\n    if (isRouge \x26\x26 wa.isFlash){\r\n      return \x2224\x22;\r\n    }\r\n    else if (isRouge){\r\n      return \x2223\x22;\r\n    }\r\n    else if (wa.isFlash){\r\n      return \x2222\x22;\r\n    }\r\n    else {\r\n      return \x2221\x22;\r\n    }\r\n  };\r\n\r\n  /* If some are missing from below, its because we converted them to angular directives which live on the element itself */\r\n  var featureSelectors \x3d [\r\n    { name: \x22hasSwatches\x22, selector: $(\x22[data-analy-swatch]\x22).length, value: \x221\x22},\r\n    { name: \x22fewLeft\x22, selector: ($(\x22[data-ana-fewLeft]:visible\x22).length), value: \x222\x22},\r\n    { name: \x22altImages\x22, selector: $(\x22[data-analy-thumb-img]\x22).length, value: \x223\x22},\r\n    { name: \x22altVideos\x22, selector: ($(\x22[data-analy-video-thumb]\x22).length || $(\x22.main-product-thumbnails .videoPopComponent\x22).length ), value: \x224\x22},\r\n    { name: \x22useItWith\x22, selector: ( $(\x22[data-ana-useItWith]\x22).length || $(\x22.ancillary-carousel\x22).length), value: \x227\x22},\r\n    { name: \x22hasRecentlyViewedCarousel\x22, selector: $(\x22[data-ana-recent]\x22).length, value: \x2213\x22 },\r\n    { name: \x22isInStore\x22, selector: (!$(\x22.online-only\x22).length \x26\x26 wa.pageName.indexOf(\x22flash\x22)\x3d\x3d-1), value: \x2214\x22},\r\n    { name: \x22addRemove\x22, selector: $(\x22.pdp-set\x22).length, value: \x2215\x22},\r\n    { name: \x22viewMoreLess\x22, selector: $(\x22.arrow-down:visible\x22).length, value: \x2216\x22},\r\n    { name: \x22isCustomSetUseCase1\x22, selector: $(\x22[seph-json-to-js\x3doptionSkus]\x22).length, value: \x2217\x22},\r\n    { name: \x22isCustomSetUseCase2\x22, selector: $(\x22[seph-json-to-js\x3dgroupedOptionProducts]\x22).length, value: \x2218\x22},\r\n    { name: \x22isCustomSetUseCase3\x22, selector: $(\x22.pdp-promo-banner:visible\x22).length, value: \x2219\x22},\r\n    { name: \x22flashMessage\x22, selector: $(\x22[data-analy-flashMsg]\x22).length, value: flashMsg()}\r\n  ];\r\n  var returnValues \x3d featureSelectors.filter(function(s) {\r\n    if (s.selector)\r\n    return s;\r\n  })\r\n  .map(function(s) {\r\n    return s.value;\r\n  })\r\n\r\n  for (; i\x3creturnValues.length; i+\x3d1){\r\n    wa.anaPageLoadInfo.features.push(returnValues[i])\r\n  }\r\n}\r\nvar f \x3d wa.anaPageLoadInfo.features;\r\n\r\nreturn f;\r\n\r\n\r\n}())', {pageId:2047990});
BrightTag.instance.dbe('campaign :: paid search keyword', 'wa.paidSearchKeyword || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('page :: previous page', 'digitalData.page.previousPageInfo.pageName || wa.prevPageName\r\n\r\n\r\n\r\n\r\n', {pageId:2047990});
BrightTag.instance.dbe('browser :: time', '(function(){var now\x3dnew Date();var _h\x3dnow.getHours();var _m\x3dpad(now.getMinutes());var _t\x3d_h\x3e11?\x22PM\x22:\x22AM\x22; _h\x3d _h \x3e 12 ? _h%12 : _h; return _h+\x22:\x22+_m+\x22\x22+_t;})()', {pageId:2047990});
BrightTag.instance.dbe('page :: type', '(function(){\r\n/* In allsephpages data bindings - This also gets set in pageLoadEvent in events*/\r\nreturn wa.pageType;\r\n}());\r\n', {pageId:2047990});
BrightTag.instance.dbe('user :: sign-in status', 'wa.getUserProp(\x22signInStatus\x22) || \x22unrecognized\x22', {pageId:2047990});
BrightTag.instance.dbe('browser :: current date', 'wa.getLocalDate()', {pageId:2047990});
BrightTag.instance.dbe('campaign :: internal campaign', '(!!wa.internalCampaign) ? wa.internalCampaign.toLowerCase() : \x22\x22\r\n\r\n\r\n', {pageId:2047990});
BrightTag.instance.dbe('time parting :: day', 'timePart(\x27d\x27, \x27-8\x27, new Date().getFullYear())', {pageId:2047990});
BrightTag.instance.dbe('campaign :: email :: harmony deployment id', 'wa.emailHarmonyDeploymentId || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('browser :: is tablet', 'wa.isTablet() ? \x22tablet web\x22 : \x22desktop web\x22\r\n', {pageId:2047990});
BrightTag.instance.dbe('campaign :: keyword id', 'wa.keywordID || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('campaign :: urs :: channel', 'wa.ursChannel || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('browser :: platform', 'wa.platform', {pageId:2047990});
BrightTag.instance.dbe('page :: bi status', '(function(){\r\n\tvar st \x3d $(\x22p.vib-state\x22);\r\n\tif(st.length){\r\n\t\tvar amt \x3d $(\x22p.vib-state [data-vibspendamount]\x22).data(\x22vibspendamount\x22);\r\n\t\tvar state \x3d st.data(\x22state\x22);\r\n\t\tvar rougeClose \x3d [\x22VIB_EXTENDED\x22, \x22NOT_VIB_QUALIFIES\x22]\r\n\t\t/* If you are already vib and you haven\x27t requalified yet, and there is a spend amount then we\x27ll report VIB_ROUGE_CLOSE */\r\n\t\tif ( rougeClose.contains(state) \x26\x26 amt \x3e 0 ){\r\n\t\t\tstate \x3d \x22VIB_ROUGE_CLOSE\x22\r\n\t\t}\r\n\r\n\t\treturn state + \x22:\x22 + (amt ? amt : \x220\x22) + \x22:\x22 + wa.pageType;\r\n\t}\r\n\treturn null;\r\n})();', {pageId:2047990});
BrightTag.instance.dbe('campaign :: affiliate id', 'wa.affiliateId || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('campaign :: email :: harmony link id', 'wa.emailHarmonyLinkId || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('campaign :: old internal campaign', 'wa.oldInternalCampaign || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('product :: finding method (pfm)', '(function() {\r\n  //All Page\r\n  if( wa.pageType \x3d\x3d \x27basket\x27 || wa.pageType \x3d\x3d \x27checkout\x27 ||  wa.pageType \x3d\x3d \x27thank you\x27 || wa.pageType \x3d\x3d \x27product\x27){\r\n    if((wa.isEmpty(wa.rURL) \x26\x26 document.referrer) || wa.wasHttps){\r\n      return \x22\x22;\r\n    }\r\n      return \x22Direct Entry\x22 + (wa.ursChannel ? \x22 by \x22 + wa.ursChannel : \x22\x22);\r\n    }\r\n   return \x22D\x3dpageName\x22;\r\n})()', {pageId:2047990});
BrightTag.instance.dbe('user :: shipping country', 'wa.getShippingCountry()', {pageId:2047990});
BrightTag.instance.dbe('campaign :: email :: harmony customer key', 'wa.emailHarmonyCustomerKey || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('user :: is flash subscriber', '(function () {\r\n\tvar biType \x3d wa.getUserProp(\x22biType\x22) \x3d\x3d\x3d \x22rouge\x22 ? \x22rouge\x22 : \x22non-rouge\x22;\r\n\tvar flash \x3d ( wa.getUserProp(\x22isFlash\x22) \x3d\x3d\x3d \x22true\x22) ? \x22+flash\x22 : \x22\x22;\r\n\treturn biType + flash;\r\n}());', {pageId:2047990});
BrightTag.instance.dbe('user :: id', 'bt_cookie(\x22DYN_USER_ID\x22)', {pageId:2047990});
BrightTag.instance.dbe('time parting :: hour', 'timePart(\x27h\x27, \x27-8\x27, new Date().getFullYear())', {pageId:2047990});
BrightTag.instance.dbe('campaign :: urs :: campaign', 'wa.ursCampaign', {pageId:2047990});
BrightTag.instance.dbe('error page url', '(wa.pageType \x26\x26 wa.pageType.indexOf(\x22404\x22)\x3e\x3d0) ? \x22D\x3dg\x22 : \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('website :: country', 'wa.country', {pageId:2047990});
BrightTag.instance.dbe('browser :: language/locale', 'wa.getLocLangPrefix(true)', {pageId:2047990});
BrightTag.instance.dbe('campaign :: natural search keyword', 'wa.naturalSearchKeyword || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('campaign :: email :: atg id', 'wa.emailATGID || \x22\x22', {pageId:2047990});
BrightTag.instance.dbe('sitecatalyst :: account id', '(function(){\r\n\r\n  return document.location.host.indexOf(\x22www.sephora.com\x22)\x3d\x3d0 ? \x22sephoracom\x22 : \x22sephorarenew\x22;\r\n}())', {pageId:2047990});
BrightTag.instance.dbe('channel', '(function() {\r\n\tvar ch \x3d wa.safelyRead(\x22digitalData.page.category.pageType\x22);\r\n\r\n\tif(!ch \x26\x26 wa.pageType \x3d\x3d\x3d \x22checkout\x22){\r\n\t\tch \x3d wa.pageType;\r\n\t\tch \x3d wa.safelyRead(\x22Sephora.$rootScope.is_play_order\x22, window) ? \x22play \x22 + ch : ch;\r\n\t\treturn ch;\r\n\t}\r\n\r\n\tif (!ch \x26\x26 !wa.isEmpty(wa.path)) {\r\n\t\tif (wa.pageType \x26\x26 wa.pageType.indexOf(\x22category\x22)\x3e\x3d0) return \x22category\x22;\r\n\t\telse if (wa.pageType \x3d\x3d \x22home page\x22) return \x22home page\x22;\r\n\t\telse return wa.path[0];\r\n\t}\r\n\treturn ch;\r\n})();', {pageId:2047990});
BrightTag.instance.appendContent('\x3cscript type\x3d\x22text/javascript\x22\x3e\n        var s_account \x3d (""+bt_data(\x27sitecatalyst :: account id\x27));\n      \x3c/script\x3e\n      \x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22//s.btstatic.com/lib/ae58af4a41c533ad6b5ce75916f85e931434a204.js?v\x3d1\x22\x3e\x3c/script\x3e\n      \x3cscript type\x3d\x22text/javascript\x22\x3e\n        var ch \x3d s.ch \x3d s.channel \x3d (""+bt_data(\x27channel\x27));\n        s.campaign \x3d (""+bt_data(\x27campaign\x27));\n        s.pageName \x3d (""+bt_data(\x27page :: name :: on-load\x27));\n        s.currencyCode \x3d \x27USD\x27;\n        s.events \x3d (""+bt_data(\x27sitecatalyst :: events string :: on-load\x27));\n        s.products \x3d (""+bt_data(\x27product string :: on-load\x27));\n        BrightTag.each([{key:"eVar1",value:"D\\x3dc4"},{key:"eVar2",value:bt_data(\x27campaign :: old internal campaign\x27)},{key:"eVar6",value:bt_data(\x27product :: finding method (pfm)\x27)},{key:"eVar8",value:"D\\x3dv0"},{key:"eVar11",value:"D\\x3dv0"},{key:"eVar12",value:"D\\x3dv0"},{key:"eVar14",value:bt_data(\x27order :: shipping :: method\x27)},{key:"eVar15",value:bt_data(\x27order :: payment :: methods\x27)},{key:"eVar16",value:bt_data(\x27order :: promo code\x27)},{key:"eVar17",value:"D\\x3dc27"},{key:"eVar18",value:"D\\x3dc9"},{key:"eVar19",value:bt_data(\x27browser :: is tablet\x27)},{key:"eVar21",value:bt_data(\x27browser :: platform\x27)},{key:"eVar25",value:bt_data(\x27order :: id\x27)},{key:"eVar27",value:bt_data(\x27campaign :: keyword id\x27)},{key:"eVar28",value:bt_data(\x27campaign :: urs :: channel\x27)},{key:"eVar29",value:bt_data(\x27campaign :: paid search keyword\x27)},{key:"eVar30",value:"D\\x3dv29"},{key:"eVar31",value:bt_data(\x27campaign :: natural search keyword\x27)},{key:"eVar35",value:bt_data(\x27campaign :: affiliate id\x27)},{key:"eVar38",value:bt_data(\x27time parting :: hour\x27)},{key:"eVar39",value:bt_data(\x27time parting :: day\x27)},{key:"eVar40",value:"D\\x3dg"},{key:"eVar44",value:bt_data(\x27campaign :: urs :: campaign\x27)},{key:"eVar45",value:bt_data(\x27campaign :: email :: harmony deployment id\x27)},{key:"eVar46",value:bt_data(\x27campaign :: email :: harmony link id\x27)},{key:"eVar47",value:bt_data(\x27campaign :: email :: harmony customer key\x27)},{key:"eVar48",value:bt_data(\x27campaign :: email :: tracking code\x27)},{key:"eVar49",value:bt_data(\x27campaign :: email :: atg id\x27)},{key:"eVar50",value:"D\\x3dc6"},{key:"eVar55",value:"D\\x3dc8"},{key:"eVar58",value:"D\\x3dUser-Agent"},{key:"eVar59",value:"D\\x3dc9"},{key:"eVar62",value:bt_data(\x27browser :: language/locale\x27)},{key:"eVar63",value:"D\\x3dg"},{key:"eVar64",value:bt_data(\x27navigation :: previous link clicked\x27)},{key:"eVar67",value:"D\\x3dc4"},{key:"eVar68",value:bt_data(\x27product out of stock tracking :: evar68\x27)},{key:"eVar71",value:bt_data(\x27page :: bi status\x27)},{key:"eVar74",value:bt_data(\x27user :: is flash subscriber\x27)},{key:"eVar75",value:bt_data(\x27campaign :: internal campaign\x27)+" "},{key:"prop1",value:bt_data(\x27page :: category\x27)},{key:"prop3",value:bt_data(\x27page :: type\x27)},{key:"prop4",value:bt_data(\x27search :: term\x27)},{key:"prop5",value:bt_data(\x27search :: redirect\x27)},{key:"prop6",value:bt_data(\x27page :: previous page\x27)},{key:"prop8",value:bt_data(\x27user :: beauty status\x27)},{key:"prop9",value:bt_data(\x27user :: id\x27)},{key:"prop10",value:bt_data(\x27website :: country\x27)},{key:"prop15",value:"D\\x3dv21+\\x22:\\x22+pageName"},{key:"prop17",value:bt_data(\x27campaign :: old internal campaign\x27)},{key:"prop25",value:bt_data(\x27browser :: current date\x27)},{key:"prop26",value:bt_data(\x27error page url\x27)},{key:"prop27",value:bt_data(\x27user :: sign-in status\x27)},{key:"prop30",value:"D\\x3dc8+\\x22:\\x22+pageName"},{key:"prop35",value:bt_data(\x27basket :: country path\x27)},{key:"prop39",value:bt_data(\x27browser :: time\x27)},{key:"prop46",value:"D\\x3dv62"},{key:"prop48",value:bt_data(\x27page :: error message\x27)},{key:"prop55",value:bt_data(\x27page load info :: prop55\x27)},{key:"prop61",value:bt_data(\x27bihq :: default tab\x27)},{key:"prop63",value:bt_data(\x27page :: detect features\x27)},{key:"prop70",value:bt_data(\x27user :: shipping country\x27)},{key:"hier1",value:bt_data(\x27hier1\x27)},{key:"hier2",value:bt_data(\x27heir2\x27)},{key:"zip",value:bt_data(\x27order :: shipping :: postalcode\x27)},{key:"state",value:bt_data(\x27order :: shipping :: state\x27)},{key:"purchaseID",value:bt_data(\x27order :: purchase id\x27)}], function (param) {\n          s[param.key] \x3d param.value;\n        });\n        BrightTag.eval("/*prop55 skincareIQ left nav click in sephoraAnalytics.js\\n   prop57 \\x26 59 set for Store Search in eventBridge.js\\n*/\\nwa.manuallyUpdateS();\\n\\n//s.prop62\\x3d s.getPercentPageViewed(location.href)[1];\\ns.prop19 \\x3d (typeof(Visitor) !\\x3d \\x22undefined\\x22 ? \\x22VisitorAPI Present\\x22 : \\x22VisitorAPI Missing\\x22);");\n        var s_code \x3d s.t();\n        if (s_code) { document.write(s_code); }\n      \x3c/script\x3e',{tagId:3432254});
